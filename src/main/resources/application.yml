server:
  port: 8081
  servlet:
    context-path: /api

spring:
  application:
    name: dingding-demo
  jackson:
    date-format: yyyy-MM-dd HH:mm:ss
    time-zone: GMT+8
  # Redis配置
  redis:
    host: 172.17.0.32
    port: 6379
    password: JJKhisredis2021%
    database: 0
    timeout: 5000ms
    lettuce:
      pool:
        max-active: 8
        max-wait: -1ms
        max-idle: 8
        min-idle: 0
  # 数据源配置
  datasource:
    url: jdbc:mysql://172.17.0.32:4000/his-prod?useUnicode=true&characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=true&serverTimezone=GMT%2B8&rewriteBatchedStatements=true&autoReconnect=true&allowMultiQueries=true
    username: root
    password: JJKhisdata2021%
    driver-class-name: com.mysql.cj.jdbc.Driver
  # MyBatis-Plus配置
  mybatis-plus:
    configuration:
      log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
      map-underscore-to-camel-case: true
    global-config:
      db-config:
        logic-delete-field: deleted
        logic-delete-value: 1
        logic-not-delete-value: 0
    mapper-locations: classpath*:mapper/**/*.xml
    # 注册类型处理器
    type-handlers-package: com.example.dingding.handler

# 钉钉应用配置
dingding:
  # 应用基础信息
  app:
    # 应用名称（用于标识不同应用）
    name: "HIS云平台"
    # 钉钉应用的AppKey（请在钉钉开放平台获取）
    app-key: dingx6dp0ie8pzjijz91
    # 钉钉应用的AppSecret（请在钉钉开放平台获取）
    app-secret: 3T5BdvjcaTdDSxFvqR7LakjtsNJlmmGcbQsLosHjLBHm0ZlTz9l2b8xtq9-hllKA
    # 企业ID（可选，部分API需要）
    corp-id: dingeafcf6304ce68e35
    # 应用类型（INTERNAL/ISV）
    app-type: "INTERNAL"

  # API配置
  api:
    # 钉钉API基础地址
    base-url: https://oapi.dingtalk.com
    # 获取access_token的API
    token-url: /gettoken
    # 获取部门列表的API
    department-list-url: /topapi/v2/department/listsub
    # 获取表单实例详情的API
    form-instance-url: /premium/getforminstance
    # HTTP连接超时时间（毫秒）
    connect-timeout: 10000
    # HTTP读取超时时间（毫秒）
    read-timeout: 15000

  # Token管理配置
  token:
    # access_token缓存时间，默认7000秒（钉钉token有效期7200秒，稍微提前刷新）
    cache-duration: 7000
    # token获取失败重试次数
    retry-times: 3

  # Redis缓存配置
  redis:
    # Redis缓存前缀
    key-prefix: "dingding:"
    # 部门列表缓存时间（秒）
    department-cache-duration: 3600

# 项目部配置
project:
  department:
    group-name: "项目部"
    target-departments:
      - "养老事业部"
      - "口腔项目部"
      - "理疗项目部"
      - "产康项目部"
      - "健康管理部"

# 日志配置
logging:
  level:
    com.example.dingding: DEBUG
    org.springframework.web: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"